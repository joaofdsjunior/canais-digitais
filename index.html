<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Inteligência de Atendimento (Dados Validados) | Suridata</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f7f9;
        }
        .chart-container {
            position: relative;
            width: 100%;
            height: 380px;
            margin-top: 1.5rem;
        }
        .main-card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 2rem;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            margin-bottom: 2.5rem;
        }
        .kpi-card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .kpi-value { font-size: 2.8rem; font-weight: 900; line-height: 1; color: #003f5c; }
        .kpi-label { font-size: 1rem; color: #4A5568; margin-top: 0.5rem; }
        .kpi-variation { font-size: 1.125rem; font-weight: 600; }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-[#003f5c] mb-2">Painel de inteligência de atendimento</h1>
            <p class="text-lg text-gray-600">Análise aprofundada com dados validados da Suridata (Jan-Jul 2025)</p>
        </header>

        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-6 text-[#374c80]">Indicadores-chave de performance (KPIs)</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                <div class="kpi-card">
                    <div class="flex items-baseline justify-center gap-2">
                        <div class="kpi-value">2854</div>
                        <div class="kpi-variation text-red-600">▲ 224%</div>
                    </div>
                    <div class="kpi-label">Interações totais</div>
                </div>
                <div class="kpi-card">
                    <div class="flex items-baseline justify-center gap-2">
                        <div class="kpi-value">711</div>
                        <div class="kpi-variation text-red-600">▲ 101%</div>
                    </div>
                    <div class="kpi-label">Respostas validadas</div>
                </div>
                <div class="kpi-card">
                    <div class="flex items-baseline justify-center gap-2">
                        <div class="kpi-value">4.8h</div>
                        <div class="kpi-variation text-green-600">▼ 22.2%</div>
                    </div>
                    <div class="kpi-label">TMR geral (mediana)</div>
                </div>
                <div class="kpi-card">
                    <div class="flex items-baseline justify-center gap-2">
                        <div class="kpi-value">2.5h</div>
                        <div class="kpi-variation text-green-600">▼ 17.9%</div>
                    </div>
                    <div class="kpi-label">TMR canais digitais</div>
                </div>
                <div class="kpi-card">
                    <div class="flex items-baseline justify-center gap-2">
                        <div class="kpi-value">5.6:1</div>
                        <div class="kpi-variation text-red-600">▲ 60%</div>
                    </div>
                    <div class="kpi-label">Ratio cliente : Suridata</div>
                </div>
            </div>
             <p class="text-xs text-center text-gray-400 mt-4">Variação percentual de Julho vs. Junho (para volume) e Junho vs. Janeiro (para TMR)</p>
        </section>

        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#374c80]">Top 10 Acionadores - Julho</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8">
                Ranking dos profissionais que mais iniciaram chamados em Julho, identificando os principais pontos de contato.
            </p>
            <div class="max-w-6xl mx-auto">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-x-6">
                    <!-- Coluna 1 -->
                    <div class="space-y-4">
                        <!-- Item 1 -->
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-gray-400 mr-3 w-6 text-center">1</span>
                                <div>
                                    <p class="font-semibold text-gray-800">Bruna Alvarenga da Silva</p>
                                    <p class="text-sm text-gray-500">AMARQ - <span class="text-xs italic">Relatórios e Acessos</span></p>
                                </div>
                            </div>
                            <div class="text-2xl font-black text-[#003f5c]">10</div>
                        </div>
                        <!-- Item 2 -->
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-gray-400 mr-3 w-6 text-center">2</span>
                                <div>
                                    <p class="font-semibold text-gray-800">Wanderlaine Mendes</p>
                                    <p class="text-sm text-gray-500">RBM - <span class="text-xs italic">Relatórios e Arquivos</span></p>
                                </div>
                            </div>
                            <div class="text-2xl font-black text-[#003f5c]">8</div>
                        </div>
                        <!-- Item 3 -->
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-gray-400 mr-3 w-6 text-center">3</span>
                                <div>
                                    <p class="font-semibold text-gray-800">Edilaine Freitas</p>
                                    <p class="text-sm text-gray-500">Ritacco / Employer - <span class="text-xs italic">Arquivos e Acessos</span></p>
                                </div>
                            </div>
                            <div class="text-2xl font-black text-[#003f5c]">8</div>
                        </div>
                         <!-- Item 4 -->
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-gray-400 mr-3 w-6 text-center">4</span>
                                <div>
                                    <p class="font-semibold text-gray-800">Fernanda Lacerda</p>
                                    <p class="text-sm text-gray-500">Unnimax - <span class="text-xs italic">Ajustes de Dados</span></p>
                                </div>
                            </div>
                            <div class="text-2xl font-black text-[#003f5c]">7</div>
                        </div>
                    </div>
                    <!-- Coluna 2 -->
                    <div class="space-y-4">
                        <!-- Item 5 -->
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-gray-400 mr-3 w-6 text-center">5</span>
                                <div>
                                    <p class="font-semibold text-gray-800">Giselle C. F. Palma</p>
                                    <p class="text-sm text-gray-500">Elopar - <span class="text-xs italic">Acessos e Planejamento</span></p>
                                </div>
                            </div>
                            <div class="text-2xl font-black text-[#003f5c]">4</div>
                        </div>
                        <!-- Item 6 -->
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-gray-400 mr-3 w-6 text-center">6</span>
                                <div>
                                    <p class="font-semibold text-gray-800">Amanda Martins</p>
                                    <p class="text-sm text-gray-500">RBM - <span class="text-xs italic">Divergências</span></p>
                                </div>
                            </div>
                            <div class="text-2xl font-black text-[#003f5c]">4</div>
                        </div>
                        <!-- Item 7 -->
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-gray-400 mr-3 w-6 text-center">7</span>
                                <div>
                                    <p class="font-semibold text-gray-800">Fernanda Vocelka</p>
                                    <p class="text-sm text-gray-500">Alupar - <span class="text-xs italic">Relatórios e Auditoria</span></p>
                                </div>
                            </div>
                            <div class="text-2xl font-black text-[#003f5c]">4</div>
                        </div>
                    </div>
                    <!-- Coluna 3 -->
                    <div class="space-y-4">
                        <!-- Item 8 -->
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-gray-400 mr-3 w-6 text-center">8</span>
                                <div>
                                    <p class="font-semibold text-gray-800">Kelly N. N. L. Coelho</p>
                                    <p class="text-sm text-gray-500">Rommanel / Steck / Samel - <span class="text-xs italic">Relatórios</span></p>
                                </div>
                            </div>
                            <div class="text-2xl font-black text-[#003f5c]">3</div>
                        </div>
                        <!-- Item 9 -->
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-gray-400 mr-3 w-6 text-center">9</span>
                                <div>
                                    <p class="font-semibold text-gray-800">Rita de Cassia J. Silva</p>
                                    <p class="text-sm text-gray-500">Autozone / Intelie - <span class="text-xs italic">Acessos e Relatórios</span></p>
                                </div>
                            </div>
                            <div class="text-2xl font-black text-[#003f5c]">3</div>
                        </div>
                        <!-- Item 10 -->
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-gray-400 mr-3 w-6 text-center">10</span>
                                <div>
                                    <p class="font-semibold text-gray-800">Aimee Carvalho</p>
                                    <p class="text-sm text-gray-500">IR77 - <span class="text-xs italic">Arquivos e Relatórios</span></p>
                                </div>
                            </div>
                            <div class="text-2xl font-black text-[#003f5c]">3</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-6 text-[#374c80]">Variação semestral do TMR por área (Jan-Jun)</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                <div class="kpi-card">
                    <div class="kpi-value text-green-600">▼ 31.4%</div>
                    <div class="kpi-label">Treinamento Saúde</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value text-green-600">▼ 21.4%</div>
                    <div class="kpi-label">Dir. Saúde</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value text-green-600">▼ 20.0%</div>
                    <div class="kpi-label">Dir. Tecnologia</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value text-green-600">▼ 17.9%</div>
                    <div class="kpi-label">Canais Digitais</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value text-green-600">▼ 14.6%</div>
                    <div class="kpi-label">Sucesso do Cliente</div>
                </div>
            </div>
             <p class="text-xs text-center text-gray-400 mt-4">Comparativo de melhora na eficiência (Jun vs. Jan)</p>
        </section>

        <!-- NOVO BLOCO ADICIONADO -->
        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#374c80]">Variação Mensal do TMR por Área</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8">
                Este gráfico de linhas mostra a oscilação percentual do TMR de cada área em comparação com o mês anterior, indicando picos de melhora ou piora na agilidade.
            </p>
            <div>
                <h3 class="text-xl font-bold text-center">Variação Percentual Mês a Mês do TMR</h3>
                <div class="chart-container">
                    <canvas id="monthlyTmrVariationChart"></canvas>
                </div>
            </div>
        </section>

        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#374c80]">Performance e volume de comunicação</h2>
             <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8">
                Acompanhar a evolução mensal do volume de respostas da equipe e do volume total de interações (incluindo clientes) oferece uma visão completa do esforço de comunicação e da eficiência do atendimento.
            </p>
            <div>
                <h3 class="text-xl font-bold text-center">Comparativo mensal: Respostas vs. Interações totais vs. TMR</h3>
                <div class="chart-container">
                    <canvas id="combinedVolumeChart"></canvas>
                </div>
            </div>
        </section>
        
        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#374c80]">Mediana Mensal do TMR por Área</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8">
                A eficiência de resposta varia conforme a complexidade tratada por cada departamento. Este gráfico mostra a evolução do TMR para cada área da Suridata. A linha será interrompida em Julho pela ausência de dados de TMR.
            </p>
            <div>
                 <h3 class="text-xl font-bold text-center">TMR mediano mensal por área Suridata</h3>
                <div class="chart-container">
                    <canvas id="monthlyTmrByDeptChart"></canvas>
                </div>
            </div>
        </section>
        
        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#374c80]">Análise de produtividade e engajamento</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8">
                Estes gráficos comparam a produtividade da equipe (respostas/dia) com o volume total de comunicação (interações/dia), normalizados por dia útil para uma análise justa da carga de trabalho real.
            </p>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <div>
                    <h3 class="text-xl font-bold text-center">Média de interações totais por dia útil</h3>
                    <div class="chart-container">
                        <canvas id="avgInteractionsPerDayChart"></canvas>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-bold text-center">Média de respostas Suridata por dia útil</h3>
                    <div class="chart-container">
                        <canvas id="avgTicketsPerDayChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#374c80]">Análise aprofundada de clientes</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8">
                Entender quais clientes mais acionam o suporte e como essa experiência evolui em termos de agilidade ajuda a focar os esforços de Sucesso do Cliente.
            </p>
            <div class="grid grid-cols-1 gap-16">
                <div>
                    <h3 class="text-xl font-bold text-center">Top 7 clientes por volume de chamados</h3>
                    <div class="chart-container">
                        <canvas id="topClientsMonthlyChart"></canvas>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-bold text-center">TMR mediano mensal dos top 7 clientes</h3>
                    <div class="chart-container">
                        <canvas id="topClientsTmrChart"></canvas>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#374c80]">Análise temática geral das solicitações</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8">
                Compreender o "porquê" dos contatos é vital. Este gráfico mostra os principais motivos que levam os clientes a procurar a Suridata, destacando as áreas que mais demandam esforço da equipe.
            </p>
            <div>
                <h3 class="text-xl font-bold text-center">Volume de chamados por categoria (tag)</h3>
                <div class="chart-container h-[420px]">
                    <canvas id="tagsVolumeChart"></canvas>
                </div>
            </div>
        </section>
        
        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#374c80]">Análise temática mensal</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8">
                Esta visão detalha a composição dos chamados mês a mês, permitindo identificar tendências e o impacto de eventos específicos nos motivos de contato dos clientes.
            </p>
            <div>
                <h3 class="text-xl font-bold text-center">Composição mensal dos chamados por categoria</h3>
                <div class="chart-container">
                    <canvas id="monthlyTagsChart"></canvas>
                </div>
            </div>
        </section>


        <section class="main-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#374c80]">Variação absoluta mês a mês</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8">
                Analisar a mudança absoluta mensal ajuda a entender o impacto real das variações, tanto no aumento do volume de respostas quanto na redução do tempo de atendimento.
            </p>
            <div>
                <h3 class="text-xl font-bold text-center">Variação absoluta mensal (Volume vs. TMR)</h3>
                <div class="chart-container">
                    <canvas id="absoluteVariationChart"></canvas>
                </div>
            </div>
        </section>

        <footer class="text-center mt-16 pt-8 border-t border-gray-200">
            <p class="text-gray-500">Painel gerado para Suridata | Análise de atendimento com dados validados</p>
        </footer>

    </div>

    <script>
        Chart.register(ChartDataLabels);

        const tooltipConfig = { plugins: { tooltip: { callbacks: { title: function(tooltipItems) { const item = tooltipItems[0]; let label = item.chart.data.labels[item.dataIndex]; if (Array.isArray(label)) { return label.join(' '); } return label; } } } } };

        // Combined Volume Chart
        const combinedVolumeCtx = document.getElementById('combinedVolumeChart');
        if (combinedVolumeCtx) {
            new Chart(combinedVolumeCtx, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul'], 
                    datasets: [{
                        label: 'Volume de respostas Suridata',
                        data: [78, 85, 94, 99, 102, 84, 169], 
                        backgroundColor: '#003f5c',
                        yAxisID: 'y',
                    }, {
                        label: 'Volume de interações totais',
                        data: [273, 298, 329, 347, 357, 294, 954], 
                        backgroundColor: '#7a5195',
                        yAxisID: 'y',
                    }, {
                        label: 'TMR Geral (h)',
                        data: [5.4, 5.1, 4.9, 4.8, 4.5, 4.2, null], 
                        type: 'line',
                        borderColor: '#ef5675', backgroundColor: '#ef5675',
                        yAxisID: 'y1', tension: 0.3
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, ...tooltipConfig,
                    plugins: { ...tooltipConfig.plugins, datalabels: { display: false } },
                    scales: {
                        y: { type: 'linear', display: true, position: 'left', title: { display: true, text: 'Nº de respostas / interações' } },
                        y1: { type: 'linear', display: true, position: 'right', title: { display: true, text: 'Horas (TMR)' }, grid: { drawOnChartArea: false } }
                    }
                }
            });
        }
        
        // Monthly TMR by Department Chart
        const monthlyTmrDeptCtx = document.getElementById('monthlyTmrByDeptChart');
        if (monthlyTmrDeptCtx) {
            new Chart(monthlyTmrDeptCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul'], 
                    datasets: [
                        { label: 'Canais Digitais', data: [2.8, 2.6, 2.7, 2.5, 2.4, 2.3, null], borderColor: '#003f5c', backgroundColor: '#003f5c', tension: 0.1 },
                        { label: 'Dir. Tecnologia', data: [20, 18, 22, 17, 19, 16, null], borderColor: '#ef5675', backgroundColor: '#ef5675', tension: 0.1 },
                        { label: 'Dir. Saúde', data: [14, 13, 15, 12, 11.5, 11, null], borderColor: '#7a5195', backgroundColor: '#7a5195', tension: 0.1 },
                        { label: 'Treinamento Saúde', data: [7, 6, 6.5, 5.5, 5, 4.8, null], borderColor: '#ffa600', backgroundColor: '#ffa600', tension: 0.1 },
                        { label: 'Sucesso do Cliente', data: [4.8, 4.9, 4.5, 4.6, 4.3, 4.1, null], borderColor: '#bc5090', backgroundColor: '#bc5090', tension: 0.1 },
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, ...tooltipConfig,
                    plugins: { 
                        ...tooltipConfig.plugins,
                        legend: { position: 'bottom' },
                        datalabels: { display: false } 
                    },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'TMR mediano (horas)' } } }
                }
            });
        }

        // NOVO GRÁFICO: Variação Mensal do TMR
        const monthlyTmrVariationCtx = document.getElementById('monthlyTmrVariationChart');
        if (monthlyTmrVariationCtx) {
            new Chart(monthlyTmrVariationCtx, {
                type: 'line',
                data: {
                    labels: ['Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                    datasets: [
                        { label: 'Canais Digitais', data: [-7.14, 3.85, -7.41, -4.00, -4.17], borderColor: '#003f5c', backgroundColor: '#003f5c', tension: 0.1, fill: false },
                        { label: 'Dir. Tecnologia', data: [-10.00, 22.22, -22.73, 11.76, -15.79], borderColor: '#ef5675', backgroundColor: '#ef5675', tension: 0.1, fill: false },
                        { label: 'Dir. Saúde', data: [-7.14, 15.38, -20.00, -4.17, -4.35], borderColor: '#7a5195', backgroundColor: '#7a5195', tension: 0.1, fill: false },
                        { label: 'Treinamento Saúde', data: [-14.29, 8.33, -15.38, -9.09, -4.00], borderColor: '#ffa600', backgroundColor: '#ffa600', tension: 0.1, fill: false },
                        { label: 'Sucesso do Cliente', data: [2.08, -8.16, 2.22, -6.52, -4.65], borderColor: '#bc5090', backgroundColor: '#bc5090', tension: 0.1, fill: false }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false, ...tooltipConfig,
                    plugins: {
                        ...tooltipConfig.plugins,
                        legend: { position: 'bottom' },
                        datalabels: { display: false },
                        tooltip: { callbacks: { label: function(context) { return `${context.dataset.label}: ${context.parsed.y.toFixed(2)}%`; } } }
                    },
                    scales: {
                        y: { 
                            title: { display: true, text: 'Variação Percentual (%)' },
                            ticks: { callback: function(value) { return value + '%'; } }
                        }
                    }
                }
            });
        }

        // Average Tickets Per Business Day
        const avgTicketsCtx = document.getElementById('avgTicketsPerDayChart');
        if (avgTicketsCtx) {
            new Chart(avgTicketsCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul'], 
                    datasets: [{
                        label: 'Média de respostas por dia útil',
                        data: [3.55, 4.25, 4.48, 4.71, 4.86, 4.20, 7.35], 
                        borderColor: '#7a5195',
                        backgroundColor: 'rgba(122, 81, 149, 0.2)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false, ...tooltipConfig,
                    plugins: {
                        ...tooltipConfig.plugins,
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            formatter: (value) => value.toFixed(2),
                            font: { weight: 'bold' },
                            color: '#374c80'
                        }
                    },
                    scales: {
                        y: { beginAtZero: false, title: { display: true, text: 'Média de respostas / dia útil' } }
                    }
                }
            });
        }
        
        // Average Interactions Per Business Day
        const avgInteractionsCtx = document.getElementById('avgInteractionsPerDayChart');
        if (avgInteractionsCtx) {
             new Chart(avgInteractionsCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul'], 
                    datasets: [{
                        label: 'Média de interações totais por dia útil',
                        data: [12.43, 14.88, 15.68, 16.49, 17.01, 14.70, 41.48], 
                        borderColor: '#bc5090',
                        backgroundColor: 'rgba(188, 80, 144, 0.2)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false, ...tooltipConfig,
                    plugins: {
                        ...tooltipConfig.plugins,
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            formatter: (value) => value.toFixed(2),
                            font: { weight: 'bold' },
                            color: '#bc5090'
                        }
                    },
                    scales: {
                        y: { beginAtZero: false, title: { display: true, text: 'Média de interações / dia útil' } }
                    }
                }
            });
        }

        // Top 7 Clientes - Volume (Gráfico de Colunas)
        const topClientsCtx = document.getElementById('topClientsMonthlyChart');
        if (topClientsCtx) {
            new Chart(topClientsCtx, {
                type: 'bar', 
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul'],
                    datasets: [
                        { label: 'RBM Corretora', data: [10, 15, 12, 18, 20, 16, 8], backgroundColor: '#003f5c' },
                        { label: 'AMARQ', data: [8, 9, 10, 11, 12, 10, 10], backgroundColor: '#374c80' },
                        { label: 'Unnimax', data: [6, 7, 8, 9, 10, 8, 7], backgroundColor: '#ff6361' },
                        { label: 'Bencorp/Magalu', data: [12, 9, 11, 10, 14, 20, 5], backgroundColor: '#ef5675' },
                        { label: 'Alvarez & Marsal', data: [7, 11, 14, 15, 13, 11, 5], backgroundColor: '#ffa600' },
                        { label: 'Sciath', data: [8, 10, 16, 14, 15, 18, 1], backgroundColor: '#7a5195' },
                        { label: '3SEG/Outros', data: [9, 8, 10, 12, 16, 14, 6], backgroundColor: '#bc5090' }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, ...tooltipConfig,
                    plugins: {
                        ...tooltipConfig.plugins,
                        legend: { position: 'bottom' },
                        datalabels: { display: false }
                    },
                    scales: { 
                        x: { stacked: false },
                        y: { beginAtZero: true, stacked: false, title: { display: true, text: 'Nº de chamados iniciados' } } 
                    }
                }
            });
        }
        
        // Top 7 Clientes - TMR (Gráfico de Colunas)
        const topClientsTmrCtx = document.getElementById('topClientsTmrChart');
        if (topClientsTmrCtx) {
            new Chart(topClientsTmrCtx, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul'],
                    datasets: [
                        { label: 'RBM Corretora', data: [5.0, 5.2, 4.8, 4.5, 4.6, 4.3, null], backgroundColor: '#003f5c' },
                        { label: 'AMARQ', data: [6.0, 5.5, 5.8, 5.2, 5.0, 4.9, null], backgroundColor: '#374c80' },
                        { label: 'Unnimax', data: [4.8, 5.0, 4.7, 4.9, 4.5, 4.6, null], backgroundColor: '#ff6361' },
                        { label: 'Bencorp/Magalu', data: [4.5, 4.2, 4.6, 4.8, 4.4, 4.1, null], backgroundColor: '#ef5675' },
                        { label: 'Alvarez & Marsal', data: [5.5, 5.6, 5.4, 5.7, 5.5, 5.3, null], backgroundColor: '#ffa600' },
                        { label: 'Sciath', data: [6.1, 5.8, 6.5, 5.9, 5.5, 5.2, null], backgroundColor: '#7a5195' },
                        { label: '3SEG/Outros', data: [7.0, 6.5, 6.0, 5.5, 5.0, 4.8, null], backgroundColor: '#bc5090' }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, ...tooltipConfig,
                    plugins: { 
                        legend: { display: true, position: 'bottom' },
                        datalabels: { display: false }
                    },
                    scales: { 
                        x: { stacked: false },
                        y: { beginAtZero: true, stacked: false, title: { display: true, text: 'TMR mediano (horas)' } } 
                    }
                }
            });
        }
        
        // Tags Volume Chart
        const tagsVolumeCtx = document.getElementById('tagsVolumeChart');
        if (tagsVolumeCtx) {
            new Chart(tagsVolumeCtx, {
                type: 'bar',
                data: {
                    labels: ['Ajuste/Divergência/Validação', 'Relatórios', 'Acesso/Login', 'Envio de Arquivos', 'Testes/Interno', 'Melhorias'],
                    datasets: [{
                        label: 'Volume de chamados',
                        data: [40, 25, 21, 13, 12, 7], 
                        backgroundColor: ['#003f5c', '#374c80', '#7a5195', '#bc5090', '#ef5675', '#ffa600'],
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, ...tooltipConfig,
                    indexAxis: 'y',
                    plugins: {
                        ...tooltipConfig.plugins,
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'right',
                            color: 'white',
                            font: { weight: 'bold' }
                        }
                    },
                    scales: {
                        x: { title: { display: true, text: 'Nº total de chamados (Jan-Jul)' } } 
                    }
                }
            });
        }

        // Monthly Tags Chart
        const monthlyTagsCtx = document.getElementById('monthlyTagsChart');
        if (monthlyTagsCtx) {
            new Chart(monthlyTagsCtx, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul'], 
                    datasets: [
                        { label: 'Ajuste/Divergência', data: [35, 38, 42, 45, 46, 38, 40], backgroundColor: '#003f5c' },
                        { label: 'Relatórios', data: [17, 19, 21, 22, 22, 18, 25], backgroundColor: '#374c80' },
                        { label: 'Acesso/Login', data: [12, 13, 14, 15, 15, 13, 21], backgroundColor: '#7a5195' },
                        { label: 'Envio de Arquivos', data: [8, 9, 9, 10, 10, 8, 13], backgroundColor: '#bc5090' },
                        { label: 'Testes/Interno', data: [4, 4, 5, 5, 5, 4, 12], backgroundColor: '#ef5675' },
                        { label: 'Melhorias', data: [2, 3, 3, 3, 3, 3, 7], backgroundColor: '#ffa600' }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, ...tooltipConfig,
                    plugins: {
                        ...tooltipConfig.plugins,
                        legend: { position: 'bottom' },
                        datalabels: { display: false }
                    },
                    scales: { 
                        x: { stacked: true }, 
                        y: { stacked: true, title: { display: true, text: 'Nº de chamados por categoria' } }
                    }
                }
            });
        }

        // Absolute Variation Chart
        const absoluteVariationCtx = document.getElementById('absoluteVariationChart');
        if (absoluteVariationCtx) {
            new Chart(absoluteVariationCtx, {
                type: 'bar',
                data: {
                    labels: ['Fev vs Jan', 'Mar vs Fev', 'Abr vs Mar', 'Mai vs Abr', 'Jun vs Mai', 'Jul vs Jun'], 
                    datasets: [
                        {
                            label: 'Variação volume de respostas',
                            data: [7, 9, 5, 3, -18, 85], 
                            backgroundColor: '#003f5c',
                            yAxisID: 'y_volume',
                            order: 2
                        },
                        {
                            label: 'Variação TMR geral (horas)',
                            data: [-0.3, -0.2, -0.1, -0.3, -0.3, 0], 
                            backgroundColor: '#ffa600',
                            yAxisID: 'y_tmr',
                            order: 1
                        }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, ...tooltipConfig,
                    plugins: { 
                        ...tooltipConfig.plugins,
                        tooltip: { callbacks: { 
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) { label += ': '; }
                                if (context.parsed.y !== null) {
                                    if(context.label === 'Jul vs Jun' && context.datasetIndex === 1) return label + 'N/A';
                                    if (context.datasetIndex === 0) {
                                        label += context.parsed.y > 0 ? `+${context.parsed.y}` : context.parsed.y;
                                    } else {
                                        label += context.parsed.y.toFixed(1) + 'h';
                                    }
                                }
                                return label;
                            }
                        }},
                        datalabels: {
                            anchor: 'end',
                            align: (context) => context.dataset.data[context.dataIndex] >= 0 ? 'end' : 'start',
                            formatter: (value, context) => {
                                if(context.label === 'Jul vs Jun' && context.datasetIndex === 1) return 'N/A';
                                if (context.datasetIndex === 0) {
                                    return value > 0 ? `+${value}` : value;
                                } else {
                                    return value.toFixed(1) + 'h';
                                }
                            },
                            font: { weight: 'bold' },
                            color: '#444'
                        }
                    },
                    scales: { 
                        y_volume: {
                            type: 'linear', display: true, position: 'left',
                            title: { display: true, text: 'Variação volume (unidades)' }
                        },
                        y_tmr: {
                            type: 'linear', display: true, position: 'right',
                            title: { display: true, text: 'Variação TMR (horas)' },
                            grid: { drawOnChartArea: false }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
